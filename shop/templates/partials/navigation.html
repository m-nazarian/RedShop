{% load static %}
{% load custom_filters %}
{% load mptt_tags %}
{% block extra_css %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/components.css' %}">
{% endblock %}

<nav class="navbar">
    <div class="navbar-container">
        <div class="navbar-logo">
            <a href="{% url 'shop:index' %}">ğŸ› ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ù…Ù†</a>
        </div>

        <div class="search-wrapper" style="position: relative; width: 100%; max-width: 500px;">

            <input type="text" id="main-search-input" placeholder="Ø¬Ø³ØªØ¬Ùˆ..." class="search-input" autocomplete="off">

            <div id="search-results-box" class="search-results-box"></div>

        </div>

        <div class="navbar-actions">
            {% with item_count=cart|length %}
                <a href="{% url 'cart:cart_detail' %}" class="navbar-cart-link">
                    <div class="cart-info-container">
                    <span class="cart-icon">ğŸ›’</span>
                        <span class="cart-info">
                            <span id="item_count" class="item-count">{{ item_count|fa_number }}</span> item,
                            <span id="total_price" class="total-price">{{ cart.get_total_price|money_format }}</span>
                        </span>
                    </div>
                </a>
            {% endwith %}
        </div>
    </div>



    <div class="navbar-con">
        {% load mptt_tags %}
        <ul class="nav-categories">
        {# âœ… ØªØºÛŒÛŒØ± Ù†Ø§Ù… Ù…ØªØºÛŒØ± Ø¨Ù‡ categories_tree #}
            {% recursetree categories_tree %}
                <li class="dropdown">
                {# Ù„ÛŒÙ†Ú© Ø¨Ù‡ ØµÙØ­Ù‡ Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ #}
                <a href="{{ node.get_absolute_url }}">{{ node.name }}</a>

                {# Ø§Ú¯Ø± ÙØ±Ø²Ù†Ø¯ Ø¯Ø§Ø±Ø¯ØŒ Ø²ÛŒØ±Ù…Ù†Ùˆ Ø±Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¨Ø¯Ù‡ #}
                    {% if not node.is_leaf_node %}
                        <ul class="submenu">
                            {{ children }}
                        </ul>
                    {% endif %}
                </li>
            {% endrecursetree %}
        </ul>



        <div class="other-link__log">
            {% if request.user.is_authenticated %}
                <a href="{% url 'account:profile' %}">{{ request.user.account.display_name|default:request.user }}</a>
                <form method="post" action="{% url 'account:logout' %}">
                    {% csrf_token %}
                    <a href="{% url 'account:logout' %}" class="logout-btn"><i class="fa fa-sign-out-alt"></i> Ø®Ø±ÙˆØ¬</a>
                </form>
                {% else %}
                <li><a href="{% url 'account:login' %}" style="color: #fff">ÙˆØ±ÙˆØ¯</a></li>
                <li><a href="{% url 'account:register' %}" style="color: #fff">Ø«Ø¨Øª Ù†Ø§Ù…</a></li>
            {% endif %}
        </div>
    </div>
</nav>

<div id="menu-overlay" class="menu-overlay"></div>