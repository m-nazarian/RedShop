{% extends 'parent/base.html' %}
{% load static %}
{% load custom_filters %}
{% block title %}ÙÙ‡Ø±Ø³Øª Ù…Ø­ØµÙˆÙ„Ø§Øª{% endblock %}

{% block content %}
<input type="hidden" id="csrf-token" value="{{ csrf_token }}">
<input type="hidden" id="page-category-slug" value="{{ category.slug|default:'' }}">

<main class="bg-gray-50 min-h-screen py-8">
    <div class="w-full max-w-[1440px] mx-auto px-4 lg:px-8">

        <div class="flex flex-col sm:flex-row justify-between items-center mb-6 bg-white p-4 rounded-xl border border-gray-200 shadow-sm gap-4">

            <h1 class="text-lg font-bold text-gray-800 flex items-center gap-2">
                <span class="text-blue-600">ğŸ“‚</span>
                {% if category %}{{ category.name }}{% else %}Ù‡Ù…Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª{% endif %}
                <span class="text-sm font-normal text-gray-500">({{ products|length|fa_number }} Ú©Ø§Ù„Ø§)</span>
            </h1>

            <div class="flex items-center gap-3 text-sm">
                <span class="text-gray-500 flex items-center gap-1">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12"></path></svg>
                    Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ:
                </span>
                <select id="sort-select" class="filter-input border border-gray-300 rounded-lg px-3 py-1.5 focus:outline-none focus:border-blue-500 bg-white text-gray-700 cursor-pointer transition-colors hover:border-blue-400" data-filter="sort">
                    <option value="newest" {% if sort_option == 'newest' %}selected{% endif %}>Ø¬Ø¯ÛŒØ¯ØªØ±ÛŒÙ†</option>
                    <option value="cheapest" {% if sort_option == 'cheapest' %}selected{% endif %}>Ø§Ø±Ø²Ø§Ù†â€ŒØªØ±ÛŒÙ†</option>
                    <option value="expensive" {% if sort_option == 'expensive' %}selected{% endif %}>Ú¯Ø±Ø§Ù†â€ŒØªØ±ÛŒÙ†</option>
                    <option value="name" {% if sort_option == 'name' %}selected{% endif %}>Ø§Ù„ÙØ¨Ø§</option>
                </select>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 items-start">

            <aside class="lg:col-span-3 hidden lg:block sticky top-24 max-h-[calc(100vh-120px)] overflow-y-auto custom-scrollbar pr-2 pb-10">
                <div id="all-filters-container">
                    {% include 'partials/all_filters_partials.html' with ordered_filters=ordered_filters %}
                </div>
            </aside>

            <div class="lg:hidden w-full mb-4">
                <button class="w-full bg-white border border-gray-300 text-gray-700 py-3 rounded-xl font-bold flex items-center justify-center gap-2 shadow-sm">
                    <span>âš¡</span> ÙÛŒÙ„ØªØ± Ù¾ÛŒØ´Ø±ÙØªÙ‡
                </button>
                </div>

            <div class="lg:col-span-9" id="product-container">
                {% include 'partials/product_list_partials.html' with products=products %}

                <div class="mt-8">
                    {% include "partials/pagination.html" with page=products %}
                </div>
            </div>

        </div>

    </div>
</main>

<style>
    .custom-scrollbar::-webkit-scrollbar { width: 4px; }
    .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #ddd; border-radius: 4px; }
</style>

{% block extra_js %}
  <script src="{% static 'js/filters.js' %}"></script>
{% endblock %}

{% endblock %}